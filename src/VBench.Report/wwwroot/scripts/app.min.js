var VBench;!function(t){var e=function(){function t(t,e,n,r){void 0===r&&(r=1),this.r=t,this.g=e,this.b=n,this.a=r}return t.prototype.getValue=function(t){return"rgba("+this.r+","+this.g+","+this.b+","+(t||this.a)+")"},t}();t.Color=e}(VBench||(VBench={})),function(e){var t=function(){function t(){this._index=0,this._colors=[new e.Color(11,95,165),new e.Color(255,148,0),new e.Color(59,20,175),new e.Color(255,213,0),new e.Color(116,9,170),new e.Color(251,254,0),new e.Color(0,153,153),new e.Color(255,116,0),new e.Color(0,204,0),new e.Color(255,0,0)],this.textColor=new e.Color(225,225,225),this.backgroundColor=new e.Color(30,30,30)}return t.prototype.newColor=function(){return this._index=this._index<this._colors.length?this._index:0,this._colors[this._index++]},t.prototype.getCurrentColor=function(){return this._colors[this._index]},t}();e.ColorGenerator=t}(VBench||(VBench={})),function(t){var e=function(){function a(){}return a.formatAsTime=function(t){if(t<=1)return t+" ns";var e=["ns","us","ms","s"],n=Math.floor(a.log(1e3,t));t/=Math.pow(Math.pow(10,n),3);var r=e[n];return e.length<=n&&59.999999<t&&(t/=60,r="min"),this.formatAsNumber(t)+" "+r},a.formatAsBytes=function(t){if(t<=1)return t+" B";var e=Math.floor(a.log(1024,t));return t/=Math.pow(1024,e),this.formatAsNumber(t)+" "+["B","KB","MB","GB","TB"][e]},a.formatAsNumber=function(t){return new Intl.NumberFormat(navigator.language).format(t)},a.format=function(t,e){switch(e){case 2:return this.formatAsBytes(t);case 1:return this.formatAsTime(t);default:return this.formatAsNumber(t)}},a.log=function(t,e){return Math.log(e)/Math.log(t)},a}();t.Formatter=e}(VBench||(VBench={})),function(h){var t=function(){function l(t,e,n){this.typeId=l.TypeCode,this.row=t,this.columnIndex=e,this.value=ko.observable(),this.difference=ko.observable(),this.isNumeric=ko.observable(!1),this.isSelected=ko.observable(!1),this.computeValue(n,t.table.columns()[e]),this.computeDifference()}return l.prototype.computeValue=function(t,e){if(this.unitKind=e.unitKind,e.isNumeric&&Array.isArray(t)){var n=this.history=t;switch(this.isNumeric(2<=n.length),e.unitKind){default:this.value(n[n.length-1]),this.rawValue=n[n.length-1];break;case 1:case 2:var r=n[n.length-1];this.value(r?r.friendlyValue:null),this.rawValue=r?r.friendlyValue:null}}else this.value(t),this.rawValue=t},l.prototype.getDataPoints=function(){if(!this.isNumeric())return[];var t,e=[];switch(this.unitKind){default:for(var n=0;n<this.history.length;n++)t=this.history[n],e.push("number"==typeof t?t:null);break;case 1:case 2:for(n=0;n<this.history.length;n++)t=this.history[n],e.push(t&&"number"==typeof t.value?t.value:null)}return e},l.prototype.computeDifference=function(){var t,e,n=this.getDataPoints();if(0!==n.length&&(null!==(t=n[n.length-1])&&t!==undefined)){switch(l.comparisonKind){case 0:e=2<=n.length?n[n.length-2]:t;break;case 1:e=t;for(var r=0;r<n.length;r++)n[r]<e&&(e=n[r]);break;case 2:e=t;for(r=0;r<n.length;r++)n[r]>e&&(e=n[r])}if(null!==e&&e!==undefined){var a=e<=t?"+":"-",i=Math.abs(t-e),o=i/(0===e?1:e)*100,s="&Delta; "+a+h.Formatter.format(i,this.unitKind);0===o||(s+=999<o?" (>999%)":" ("+(1<=o?o.toFixed(0):o.toFixed(2))+"%)"),this.difference(s)}}},l.comparisonKind=0,l.TypeCode=3,l}();h.DataCell=t}(VBench||(VBench={})),function(a){var t=function(){function t(t,e){var n=this;this.table=t,this.values=ko.observableArray(),this.key=e[0],this.isSelected=ko.observable(!1);for(var r=0;r<e.length;r++)this.values.push(new a.DataCell(this,r,e[r]));this.isSelected=ko.pureComputed(function(){for(var t=!1,e=0;e<n.values().length;e++)if(n.values()[e].isSelected()){t=!0;break}return t})}return t.prototype.refresh=function(){for(var t=0;t<this.values().length;t++)this.values()[t].computeDifference()},t}();a.DataRow=t}(VBench||(VBench={})),function(n){var t=function(){function t(){this.name=ko.observable(),this.rows=ko.observableArray(),this.columns=ko.observableArray(),this.description=ko.observable("")}return t.prototype.addColumn=function(t){var e=new n.DataColumn(this,t,this.columns().length);return this.columns.push(e),e},t.prototype.addRow=function(t){var e=new n.DataRow(this,t);return this.rows.push(e),e},t.prototype.refresh=function(){for(var t=0;t<this.rows().length;t++)this.rows()[t].refresh()},t.prototype.clear=function(){this.rows.removeAll(),this.columns.removeAll()},t.prototype.reset=function(){for(var t=0;t<this.columns().length;t++)this.columns()[t].isSelected(!1)},t}();n.DataTable=t}(VBench||(VBench={})),function(t){var e=function(){function t(t,e,n){this.table=t,this.index=n,this.unitKind=e.unitKind,this.isNumeric=e.isNumeric,this.order=ko.observable(0),this.isSelected=ko.observable(!1),this.name=ko.observable(e.name||"-")}return t.prototype.sort=function(){var a=this;console.debug("sorting "+this.name()+" column ["+this.order()+"]"),this.table.rows.sort(function(t,e){var n=t.values()[a.index].rawValue,r=e.values()[a.index].rawValue;return r<n&&0===a.order()?1:n<r&&0===a.order()?-1:r<n&&1===a.order()?-1:n<r&&1===a.order()?1:0}),this.isSelected(!0),this.order(0===this.order()?1:0)},t}();t.DataColumn=e}(VBench||(VBench={})),function(t){var e=function(){function n(){var t=this;this.email=ko.observable(),this.commitId=ko.observable(),this.emailHash=ko.observable(),this.hardwareInformation=ko.observable(),this.date=ko.observable(),this.author=ko.observable(),this.testNo=ko.observable(),this.branch=ko.observable(),this.wasClean=ko.observable(),this.avatar=ko.pureComputed(function(){return"https://www.gravatar.com/avatar/"+t.emailHash()+"?s=32"})}return n.create=function(t){var e=new n;return e.hardwareInformation(t.hardwareInformation),e.emailHash(t.emailMD5),e.email(t.email),e.commitId(t.sha),e.author(t.author),e.branch(t.branch),e.date(new Date(Date.parse(t.date))),e.wasClean(t.wasClean),e},n.prototype.copy=function(t){return this.hardwareInformation(t.hardwareInformation()),this.emailHash(t.emailHash()),this.commitId(t.commitId()),this.email(t.email()),this.date(t.date()),this.author(t.author()),this.branch(t.branch()),this},n}();t.Contributor=e}(VBench||(VBench={})),function(l){var t=function(){function t(t){void 0===t&&(t="data"),this._data=JSON.parse(document.getElementById(t).innerHTML)}return t.prototype.loadData=function(t,e,n){var r=e||new l.DataTable,a=this.fetchDataset(t),i=a.contributions;r.clear(),r.name(t),r.description(i[i.length-1].hardwareInformation);for(var o=a.columns.length,s=0;s<o;s++)r.addColumn(a.columns[s]);for(s=0;s<a.rows.length;s++)r.addRow(a.rows[s]);n.removeAll();for(s=0;s<i.length;s++)n.push(l.Contributor.create(i[s]));return r},t.prototype.fetchDatasetNames=function(){for(var t=[],e=0;e<this._data.length;e++)t.push(this._data[e].name);return t},t.prototype.fetchDataset=function(t){for(var e=0;e<this._data.length;e++)if(this._data[e].name===t)return this._data[e];return null},t}();l.Repository=t}(VBench||(VBench={})),function(a){var t=function(){function t(t){this._repository=t,this._linesEnabled=!0,this.data=new a.DataTable,this._colorPicker=new a.ColorGenerator,this._chart=this.createLineChart(),this.contributors=ko.observableArray(),this.selectedContributor=new a.Contributor}return t.prototype.changeDataset=function(t){for(void 0===t&&(t=null),this._selectedDatasetId=t||this._selectedDatasetId,this._repository.loadData(this._selectedDatasetId,this.data,this.contributors),this.selectContributor(0),this._chart.data.labels.splice(0,this._chart.data.labels.length);0<this._chart.data.datasets.length;)this._chart.data.datasets.pop();this._chart.update()},t.prototype.updateChart=function(t){var e=t.row.key,n=t.columnIndex,r=e+" ["+t.row.table.columns()[n].name()+"]";if(t.isSelected()){console.debug(r+" |> add-series");var a=t.getDataPoints();if(0<a.length){this._chart.data.labels.splice(0,this._chart.data.labels.length);for(var i=0;i<a.length;i++)this._chart.data.labels.push("Test-"+(i+1));(o=this.createSeriesBaseSettings()).data=a,o.label=r,o.vbench_unitType=t.unitKind,this._chart.data.datasets.push(o)}else console.debug("toast an error: no history")}else{console.debug(r+" |> remove-series");var o=this._chart.data.datasets;for(i=0;i<o.length;i++)if(o[i].label===r){o.splice(i,1);break}}this._chart.update()},t.prototype.selectContributor=function(t){var e=null;return t<this.contributors().length&&(e=this.selectedContributor.copy(this.contributors()[t])).testNo(t),e},t.prototype.toggleChartLines=function(){var e=this;this._linesEnabled=!this._linesEnabled;var n=this.createSeriesBaseSettings();return this._chart.data.datasets.forEach(function(t){t.showLine=e._linesEnabled,t.pointStyle=n.pointStyle,t.pointRadius=n.pointRadius,t.pointBorderWidth=n.pointBorderWidth}),this._chart.update(),this._linesEnabled},t.prototype.createLineChart=function(){var r=this,t=this._colorPicker.textColor,e=this._colorPicker.textColor;return new Chart(document.getElementById("chart"),{type:"line",data:{datasets:[]},options:{scales:{xAxes:[{gridLines:{color:e.getValue(.25)},ticks:{fontColor:t.getValue(.75)}}],yAxes:[{gridLines:{display:!0,color:e.getValue(.05)},ticks:{display:!1,beginAtZero:!0,fontColor:t.getValue(.5)}}]},tooltips:{titleFontSize:18,bodyFontSize:18,bodyFontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",cornerRadius:0,xPadding:12,yPadding:12,callbacks:{label:function(t,e){r.selectContributor(t.index);var n=e.datasets[t.datasetIndex];return" "+n.label+": "+a.Formatter.format(n.data[t.index],n.vbench_unitType)}}}}})},t.prototype.createSeriesBaseSettings=function(){var t=this._colorPicker.newColor();return{fill:!1,pointHitRadius:20,showLine:this._linesEnabled,backgroundColor:t.getValue(),borderColor:[t.getValue(.75)],pointRadius:this._linesEnabled?3:20,pointBorderWidth:(this._linesEnabled,6),pointStyle:this._linesEnabled?"circle":"line"}},t}();a.Timeline=t}(VBench||(VBench={})),function(t){var e=function(){function t(){}return t.sendHttpRequest=function(t,n,e,r){var a=new XMLHttpRequest;a.open(t,n,!0),a.setRequestHeader("Content-Type","application/json; charset=UTF-8"),a.onreadystatechange=function(){if(4===this.readyState){var t=void 0;try{t=JSON.parse(this.responseText)}catch(e){t=!1}r&&(200===this.status?r(null,t):r({error:"failure: '"+n+"'; "+this.statusText,status:this.status,data:t},t))}},a.send(JSON.stringify(e))},t.getData=function(t,e,n){return this.sendHttpRequest("GET",t,e,n)},t.postData=function(t,e,n){return this.sendHttpRequest("POST",t,e,n)},t}();t.Service=e}(VBench||(VBench={})),function(o){var t=function(){function t(){this._repository=new o.Repository;var t=this._repository.fetchDatasetNames();this.datasetTabs=ko.observableArray(t),this.selectedDataset=ko.observable(t[0]),this.timeline=new o.Timeline(this._repository),this.timeline.changeDataset(t[0])}return t.prototype.attachEventHandlers=function(){var r=this;document.getElementById("timeline-table").addEventListener("click",function(t){var e=ko.contextFor(t.target);if(e.$data.typeId===o.DataCell.TypeCode){var n=e.$data;n.isNumeric()&&(n.isSelected(!n.isSelected()),r.timeline.updateChart(n)),console.debug(n.unitKind+": "+n.isNumeric())}});var n=document.getElementById("chart-lines-btn");n&&n.addEventListener("click",function(t){var e=r.timeline.toggleChartLines();n.getElementsByClassName("chart-lines-btn-value")[0].innerHTML=e?"on":"off"});var e=document.getElementById("compute-menu");e&&e.addEventListener("click",function(t){o.DataCell.comparisonKind=e.selectedIndex,r.timeline.data.refresh()},{passive:!0});for(var a=document.getElementsByClassName("tab-btn"),t=0;t<a.length;t++)a[t].addEventListener("click",function(t){for(var e=0;e<a.length;e++)a[e].classList.remove("is-active");var n=ko.contextFor(this);this.classList.add("is-active"),r.timeline.changeDataset(n.$data),r.selectedDataset(n.$data)});a[0].classList.add("is-active");var i=document.getElementsByClassName("sortable");for(t=0;t<i.length;t++)i[t].addEventListener("click",function(t){r.timeline.data.reset(),ko.contextFor(this).$data.sort()})},t}();o.HomePage=t}(VBench||(VBench={}));
//# sourceMappingURL=app.min.js.map